const DEFAULT_TEXT = `# ๐ ูุฑุญุจุงู ุจู ูู "ุงุณุชูุฏูู ุงููุณุชูุฏุงุช"

ูุฐุง ุงููุญุฑุฑ ุงููุชุทูุฑ ูุชูุญ ูู ูุชุงุจุฉ ุงูุชูุงุฑูุฑุ ุงูุจุญูุซุ ูุงูููุงูุงุช ุจุชูุณูู **Markdown** ูุชุญููููุง ุฅูู ูููุงุช **PDF** ุงุญุชุฑุงููุฉ ูุฌุงูุฒุฉ ููุทุจุงุนุฉ ููุฑุงู.

## ๐ ูููุฒุงุช ูุฐุง ุงูุฅุตุฏุงุฑ (v3.0)
1. **ุชุญูู ูุงูู:** ุงุถุบุท ุนูู ุฃููููุฉ ุงูุฅุนุฏุงุฏุงุช (โ๏ธ) ูู ุงูุฃุนูู ูุชุบููุฑ **ุงูููุงูุด**ุ **ุญุฌู ุงูุฎุท**ุ ู **ุชุจุงุนุฏ ุงูุฃุณุทุฑ** ูุน ูุนุงููุฉ ุญูุฉ.
2. **ุทุจุงุนุฉ ุฐููุฉ:** ุชู ุญู ูุดุงูู ูุต ุงููุตูุตุ ุงูุตูุญุงุช ุงูุฌุฏูุฏุฉ ุชุจุฏุฃ ุจููุงูุด ุณูููุฉ ุชููุงุฆูุงู.
3. **ุฃุฏูุงุช ุณุฑูุนุฉ:** ุงุณุชุฎุฏู ุฃุฒุฑุงุฑ "ูุณุฎ" ู "ูุณุญ" ูู ุดุฑูุท ุงูุฃุฏูุงุช ูุชุณููู ุงูุนูู.

---

## ๐ ุฏููู ุงููุชุงุจุฉ ุงูุณุฑูุน

### 1. ุชูุณูู ุงููุตูุต
ููููู ุฌุนู ุงููุต **ุนุฑูุถุงู** (ุจูุถุน ูุฌูุชูู) ุฃู *ูุงุฆูุงู* (ุจูุฌูุฉ ูุงุญุฏุฉ) ุฃู ~~ูุดุทูุจุงู~~ ุจุณูููุฉ.

### 2. ุงูููุงุฆู
* ูุฐู ูุงุฆูุฉ ููุทูุฉ.
* ุนูุตุฑ ุขุฎุฑ ูู ุงููุงุฆูุฉ.
    * ุนูุตุฑ ูุฑุนู (ูุณุงูุฉ ุจุงุฏุฆุฉ).

1. ูุฐู ูุงุฆูุฉ ูุฑููุฉ.
2. ุงูุฎุทูุฉ ุงูุซุงููุฉ.

### 3. ุงูุงูุชุจุงุณุงุช ุงููููุฒุฉ
> "ุงูุฅุชูุงู ูู ุฃู ุชูุนู ุงูุดูุก ุงูุตุญูุญ ุญุชู ุนูุฏูุง ูุง ูุฑุงูุจู ุฃุญุฏ."
> โ *ุนุจุงุฑุฉ ุชุธูุฑ ุจุฎูููุฉ ุฑูุงุฏูุฉ ุฃูููุฉ ูุญุฏ ุฌุงูุจู ูููู.*

### 4. ุงูุฌุฏุงูู (ููุณูุฉ ุชููุงุฆูุงู)
| ู | ุงูุฎุฏูุฉ | ุงูุณุนุฑ | ุงูุญุงูุฉ |
| :--- | :--- | :--- | :--- |
| 1 | ุชุตููู ุดุนุงุฑ | $50 | โ ููุชูู |
| 2 | ุจุฑูุฌุฉ ูููุน | $200 | โณ ููุฏ ุงูุนูู |

### 5. ุงูุฃููุงุฏ ุงูุจุฑูุฌูุฉ
\`\`\`javascript
// ูุซุงู ุนูู ููุฏ ูุธูุฑ ุจุฎูููุฉ ุฏุงููุฉ ูุชูุณูู ุงุญุชุฑุงูู
function welcomeUser() {
    alert("ุฃููุงู ุจู ูู ุงุณุชูุฏูู ุงููุณุชูุฏุงุช");
}
\`\`\`

---

## ๐ ููููุฉ ูุตู ุงูุตูุญุงุช ูุฏููุงู
ุงูุจุฑูุงูุฌ ูููู ุจุฅูุดุงุก ุตูุญุงุช ุฌุฏูุฏุฉ ุชููุงุฆูุงู ุนูุฏ ุงูุชูุงุก ุงููุฑูุฉุ ูููู ุฅุฐุง ุฃุฑุฏุช ุฅุฌุจุงุฑ ุงููุต ุนูู ุงูุงูุชูุงู ูุตูุญุฉ ุฌุฏูุฏุฉุ ุงูุชุจ ูุฐุง ุงูููุฏ ูู ุณุทุฑ ูููุตู:
\`---page---\`

ุดุงูุฏ ุงููุชูุฌุฉ ูู ุงูุฃุณูู ๐

---page---

# ุงูุตูุญุฉ ุงูุซุงููุฉ ๐
ูุฐู ุงูุตูุญุฉ ุจุฏุฃุช ููุง ูุฏููุงู.

ูุงุญุธ ุฃู **ุงูููุงูุด ุงูุนูููุฉ** ูุถุจูุทุฉ ุจุฏูุฉ (2 ุณู) ููู ููุชุตู ุงููุต ุจุญุงูุฉ ุงููุฑูุฉุ ูุฐูู ุจูุถู ูุธุงู ุงูุทุจุงุนุฉ ุงูุฐูู ุงูุฌุฏูุฏ.

ููููู ุงูุงุณุชูุฑุงุฑ ูู ุงููุชุงุจุฉ ููุง...
`;

const UI = {
    // ุงูุนูุงุตุฑ ุงูุฑุฆูุณูุฉ
    editor: document.getElementById('markdown-input'),
    preview: document.getElementById('preview-container'),
    
    // ุงูุชุจููุจุงุช
    tabEditor: document.getElementById('tab-editor'),
    tabPreview: document.getElementById('tab-preview'),
    
    // ุงูุฃุฒุฑุงุฑ ุงูุนูููุฉ
    btnDir: document.getElementById('btn-direction'),
    iconDir: document.getElementById('icon-direction'),
    btnSettings: document.getElementById('btn-settings'),
    
    // ุฃุฏูุงุช ุงููุญุฑุฑ
    btnPaste: document.getElementById('btn-paste'),
    btnClear: document.getElementById('btn-clear'),

    // ูุงูุฐุฉ ุงูุฅุนุฏุงุฏุงุช
    modal: document.getElementById('settings-modal'),
    modalContent: document.getElementById('modal-content'),
    btnCloseSettings: document.getElementById('btn-close-settings'),
    btnSaveSettings: document.getElementById('btn-save-settings'),
    
    // ุฃุฏูุงุช ุงูุชุญูู ุจุงูุฅุนุฏุงุฏุงุช
    btnsMargin: document.querySelectorAll('.setting-btn-margin'),
    rangeFontSize: document.getElementById('range-font-size'),
    fontSizeDisplay: document.getElementById('font-size-display'),
    btnsLine: document.querySelectorAll('.setting-btn-line'),
    
    // ุนูุงุตุฑ ุงููุนุงููุฉ
    printStyle: document.getElementById('dynamic-print-style'),
    miniPreview: document.getElementById('mini-preview-box'),

    // ุงูุญุงูุฉ ุงูุงูุชุฑุงุถูุฉ
    state: {
        margin: '20mm',
        previewPadding: '20px',
        fontSize: '12',
        lineHeight: '1.7'
    },

    init() {
        this.editor.value = DEFAULT_TEXT;
        this.render();
        this.updatePrintStyle();
        this.events();
    },

    render() {
        let text = this.editor.value;
        // ุงุณุชุจุฏุงู ูุงุตู ุงูุตูุญุงุช
        text = text.replace(/^---page---$/gm, '<div class="page-break"></div>');
        this.preview.innerHTML = marked.parse(text);
    },

    // ุชุญุฏูุซ CSS ุฏููุงููููุงู
    updatePrintStyle() {
        // 1. ุชุญุฏูุซ ุงูุณุชุงูู ุงูุนุงู ูุงูุทุจุงุนุฉ
        this.printStyle.innerHTML = `
            @page { size: A4; margin: ${this.state.margin}; }
            .a4-sheet { padding: ${this.state.margin}; }
            :root {
                --doc-font-size: ${this.state.fontSize}pt;
                --doc-line-height: ${this.state.lineHeight};
            }
        `;

        // 2. ุชุญุฏูุซ ุงููุนุงููุฉ ุงูุญูุฉ ูู ุงููุงูุฐุฉ
        if(this.miniPreview) {
            this.miniPreview.style.fontSize = `${this.state.fontSize}pt`;
            this.miniPreview.style.lineHeight = this.state.lineHeight;
            this.miniPreview.style.padding = this.state.previewPadding;
            
            if(this.fontSizeDisplay) {
                this.fontSizeDisplay.textContent = `${this.state.fontSize}pt`;
            }
        }
    },

    events() {
        // ุงููุชุงุจุฉ
        this.editor.addEventListener('input', () => this.render());

        // ุงูุชุจููุจุงุช (ููุจุงูู)
        this.tabEditor.addEventListener('click', () => {
            document.body.classList.remove('mobile-show-preview');
            this.updateTabStyles(true);
        });
        this.tabPreview.addEventListener('click', () => {
            document.body.classList.add('mobile-show-preview');
            this.updateTabStyles(false);
        });

        // ุชุบููุฑ ุงูุงุชุฌุงู (ูุน ุชุบููุฑ ุงูุฃููููุฉ)
        this.btnDir.addEventListener('click', () => {
            const current = this.preview.getAttribute('dir') || 'rtl';
            const newDir = current === 'rtl' ? 'ltr' : 'rtl';
            this.preview.setAttribute('dir', newDir);
            
            // ุชุจุฏูู ุงูุฃููููุฉ
            this.iconDir.textContent = newDir === 'ltr' ? 'format_textdirection_l_to_r' : 'format_textdirection_r_to_l';
        });

        // ุฒุฑ ุงููุตู
        if(this.btnPaste) {
            this.btnPaste.addEventListener('click', async () => {
                try {
                    const text = await navigator.clipboard.readText();
                    const start = this.editor.selectionStart;
                    const end = this.editor.selectionEnd;
                    const val = this.editor.value;
                    this.editor.value = val.substring(0, start) + text + val.substring(end);
                    this.editor.selectionStart = this.editor.selectionEnd = start + text.length;
                    this.editor.focus();
                    this.render();
                } catch (err) { alert('ูุฑุฌู ุงูุณูุงุญ ุจุงููุตูู ููุญุงูุธุฉ'); }
            });
        }

        // ุฒุฑ ุงููุณุญ
        if(this.btnClear) {
            this.btnClear.addEventListener('click', () => {
                if(this.editor.value && confirm('ูุณุญ ุงูููุ')) {
                    this.editor.value = '';
                    this.render();
                }
            });
        }

        // --- ุฅุฏุงุฑุฉ ูุงูุฐุฉ ุงูุฅุนุฏุงุฏุงุช ---
        
        // ูุชุญ
        this.btnSettings.addEventListener('click', () => {
            this.modal.classList.remove('hidden');
            this.modal.classList.add('flex');
            this.updatePrintStyle(); // ุชุญุฏูุซ ุงููุนุงููุฉ ุนูุฏ ุงููุชุญ
            setTimeout(() => {
                this.modal.classList.remove('opacity-0');
                this.modalContent.classList.remove('scale-95');
                this.modalContent.classList.add('scale-100');
            }, 10);
        });

        // ุฅุบูุงู
        const closeSettings = () => {
            this.modal.classList.add('opacity-0');
            this.modalContent.classList.remove('scale-100');
            this.modalContent.classList.add('scale-95');
            setTimeout(() => {
                this.modal.classList.remove('flex');
                this.modal.classList.add('hidden');
            }, 200);
        };
        this.btnCloseSettings.addEventListener('click', closeSettings);
        this.btnSaveSettings.addEventListener('click', closeSettings);
        this.modal.addEventListener('click', (e) => {
            if(e.target === this.modal) closeSettings();
        });

        // ุงูุชุญูู ุจุงูููุงูุด
        this.btnsMargin.forEach(btn => {
            btn.addEventListener('click', () => {
                // ุชุญุฏูุซ ุดูู ุงูุฃุฒุฑุงุฑ
                this.btnsMargin.forEach(b => b.className = "setting-btn-margin border-2 rounded-lg py-2 text-sm font-medium hover:bg-indigo-50 hover:border-indigo-200 transition");
                btn.className = "setting-btn-margin border-2 border-indigo-600 bg-indigo-50 text-indigo-700 rounded-lg py-2 text-sm font-bold transition";
                
                // ุชุญุฏูุซ ุงูููู
                this.state.margin = btn.dataset.val;
                this.state.previewPadding = btn.dataset.previewPadding;
                this.updatePrintStyle();
            });
        });

        // ุงูุชุญูู ุจุญุฌู ุงูุฎุท
        this.rangeFontSize.addEventListener('input', (e) => {
            this.state.fontSize = e.target.value;
            this.updatePrintStyle();
        });

        // ุงูุชุญูู ุจุชุจุงุนุฏ ุงูุฃุณุทุฑ
        this.btnsLine.forEach(btn => {
            btn.addEventListener('click', () => {
                this.btnsLine.forEach(b => b.className = "setting-btn-line flex-1 py-1.5 text-sm rounded-md transition hover:bg-gray-200");
                btn.className = "setting-btn-line flex-1 py-1.5 text-sm bg-white shadow-sm font-bold text-indigo-700 rounded-md transition";
                
                this.state.lineHeight = btn.dataset.val;
                this.updatePrintStyle();
            });
        });
    },

    updateTabStyles(isEditor) {
        if(isEditor) {
            this.tabEditor.className = "px-3 py-1 text-xs font-bold shadow-sm bg-white text-slate-800 rounded-md transition-all";
            this.tabPreview.className = "px-3 py-1 text-xs font-bold text-slate-500 hover:text-slate-700 transition-all";
        } else {
            this.tabPreview.className = "px-3 py-1 text-xs font-bold shadow-sm bg-white text-slate-800 rounded-md transition-all";
            this.tabEditor.className = "px-3 py-1 text-xs font-bold text-slate-500 hover:text-slate-700 transition-all";
        }
    }
};

document.addEventListener('DOMContentLoaded', () => UI.init());